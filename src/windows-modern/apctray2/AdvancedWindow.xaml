<Window x:Class="apctray2.AdvancedWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
        Title="apcctrl - Dashboard AvanÃ§ado" Height="720" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#1E1E1E">
  
  <Window.Resources>
    <Style x:Key="CardStyle" TargetType="Border">
      <Setter Property="Background" Value="#2D2D30"/>
      <Setter Property="BorderBrush" Value="#3E3E42"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="CornerRadius" Value="8"/>
      <Setter Property="Padding" Value="16"/>
      <Setter Property="Margin" Value="8"/>
    </Style>
    
    <Style x:Key="CardTitleStyle" TargetType="TextBlock">
      <Setter Property="FontSize" Value="14"/>
      <Setter Property="FontWeight" Value="SemiBold"/>
      <Setter Property="Foreground" Value="#E0E0E0"/>
      <Setter Property="Margin" Value="0,0,0,12"/>
    </Style>
  </Window.Resources>
  
  <Grid Margin="16">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- Header com indicador de modo -->
    <Grid Grid.Row="0" Margin="0,0,0,16">
      <StackPanel Orientation="Horizontal">
        <TextBlock Text="âš¡" FontSize="24" Margin="0,0,8,0" Foreground="#00A4EF"/>
        <StackPanel>
          <TextBlock Text="{Binding UpsName}" FontSize="18" FontWeight="Bold" Foreground="#E0E0E0"/>
          <TextBlock Text="{Binding Status}" FontSize="12" Foreground="#AAAAAA"/>
        </StackPanel>
      </StackPanel>
      
      <!-- Indicador de modo (ONLINE/BATERIA) -->
      <Border x:Name="ModeIndicator" HorizontalAlignment="Right" 
              Background="#10B981" CornerRadius="20" Padding="16,8">
        <StackPanel Orientation="Horizontal">
          <TextBlock x:Name="ModeIcon" Text="ðŸ”Œ" FontSize="16" Margin="0,0,8,0"/>
          <TextBlock x:Name="ModeText" Text="MODO REDE" FontSize="14" FontWeight="Bold" Foreground="#FFFFFF"/>
        </StackPanel>
      </Border>
    </Grid>

    <!-- Tabs -->
    <TabControl Grid.Row="2" Background="#1E1E1E" BorderThickness="0">
      <TabControl.Resources>
        <Style TargetType="TabItem">
          <Setter Property="Background" Value="#2D2D30"/>
          <Setter Property="Foreground" Value="#E0E0E0"/>
          <Setter Property="FontSize" Value="13"/>
          <Setter Property="Padding" Value="16,8"/>
          <Setter Property="Template">
            <Setter.Value>
              <ControlTemplate TargetType="TabItem">
                <Border x:Name="Border" Background="{TemplateBinding Background}" 
                        BorderThickness="0" CornerRadius="6,6,0,0" Margin="2,0" Padding="{TemplateBinding Padding}">
                  <ContentPresenter ContentSource="Header" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <ControlTemplate.Triggers>
                  <Trigger Property="IsSelected" Value="True">
                    <Setter TargetName="Border" Property="Background" Value="#0078D4"/>
                  </Trigger>
                  <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="Border" Property="Background" Value="#3E3E42"/>
                  </Trigger>
                </ControlTemplate.Triggers>
              </ControlTemplate>
            </Setter.Value>
          </Setter>
        </Style>
      </TabControl.Resources>
      
      <!-- Tab: GrÃ¡ficos -->
      <TabItem Header="ðŸ“Š GrÃ¡ficos em Tempo Real">
        <Grid Background="#1E1E1E" Margin="8">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>

          <!-- Controles de Range Temporal -->
          <StackPanel Grid.Row="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="8" HorizontalAlignment="Right">
            <TextBlock Text="ðŸ“… Range:" VerticalAlignment="Center" Foreground="#E0E0E0" Margin="0,0,8,0"/>
            <ComboBox x:Name="RangeComboBox" Width="120" SelectedIndex="0" SelectionChanged="RangeComboBox_SelectionChanged"
                      Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42">
              <ComboBoxItem Content="1 hora"/>
              <ComboBoxItem Content="6 horas"/>
              <ComboBoxItem Content="24 horas"/>
              <ComboBoxItem Content="Personalizado"/>
            </ComboBox>
            <DatePicker x:Name="StartDatePicker" Margin="8,0,4,0" Visibility="Collapsed" 
                        SelectedDateChanged="CustomRange_Changed"
                        Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42"/>
            <TextBlock Text="atÃ©" VerticalAlignment="Center" Foreground="#E0E0E0" Margin="4,0" Visibility="Collapsed" x:Name="DateSeparator"/>
            <DatePicker x:Name="EndDatePicker" Margin="4,0,0,0" Visibility="Collapsed"
                        SelectedDateChanged="CustomRange_Changed"
                        Background="#2D2D30" Foreground="#E0E0E0" BorderBrush="#3E3E42"/>
          </StackPanel>

          <!-- GrÃ¡fico: Bateria -->
          <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource CardStyle}">
            <StackPanel>
              <TextBlock Text="ðŸ”‹ Carga da Bateria (%)" Style="{StaticResource CardTitleStyle}"/>
              <lvc:CartesianChart x:Name="BatteryChart" Height="200"/>
            </StackPanel>
          </Border>

          <!-- GrÃ¡fico: Carga -->
          <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource CardStyle}">
            <StackPanel>
              <TextBlock Text="âš¡ Carga do UPS (%)" Style="{StaticResource CardTitleStyle}"/>
              <lvc:CartesianChart x:Name="LoadChart" Height="200"/>
            </StackPanel>
          </Border>

          <!-- GrÃ¡fico: TensÃ£o -->
          <Border Grid.Row="2" Grid.Column="0" Style="{StaticResource CardStyle}">
            <StackPanel>
              <TextBlock Text="ðŸ”Œ TensÃ£o (V)" Style="{StaticResource CardTitleStyle}"/>
              <lvc:CartesianChart x:Name="VoltageChart" Height="200"/>
            </StackPanel>
          </Border>

          <!-- GrÃ¡fico: Consumo -->
          <Border Grid.Row="2" Grid.Column="1" Style="{StaticResource CardStyle}">
            <StackPanel>
              <TextBlock Text="ðŸ’¡ Consumo (W)" Style="{StaticResource CardTitleStyle}"/>
              <lvc:CartesianChart x:Name="WattsChart" Height="200"/>
            </StackPanel>
          </Border>
        </Grid>
      </TabItem>

      <!-- Tab: Logs -->
      <TabItem Header="ðŸ“ Log de Eventos">
        <Border Style="{StaticResource CardStyle}" Margin="8">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <TextBlock Grid.Row="0" Text="ðŸ“ Eventos Recentes" Style="{StaticResource CardTitleStyle}"/>
            
            <ListBox x:Name="LogList" Grid.Row="1" 
                     Background="#252526" 
                     Foreground="#E0E0E0"
                     BorderThickness="0"
                     FontFamily="Consolas"
                     FontSize="11"
                     ScrollViewer.VerticalScrollBarVisibility="Auto"/>
            
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
              <Button Content="ðŸ”„ Atualizar" Click="RefreshLogs_Click" 
                      Background="#3E3E42" Foreground="#E0E0E0" 
                      BorderThickness="0" Padding="12,6" Margin="0,0,8,0" Cursor="Hand"/>
              <Button Content="ðŸ—‘ï¸ Limpar" Click="ClearLogs_Click" 
                      Background="#3E3E42" Foreground="#E0E0E0" 
                      BorderThickness="0" Padding="12,6" Cursor="Hand"/>
            </StackPanel>
          </Grid>
        </Border>
      </TabItem>

      <!-- Tab: InformaÃ§Ãµes TÃ©cnicas -->
      <TabItem Header="â„¹ï¸ InformaÃ§Ãµes TÃ©cnicas">
        <ScrollViewer Background="#1E1E1E" VerticalScrollBarVisibility="Auto">
          <StackPanel Margin="8">
            <Border Style="{StaticResource CardStyle}">
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Grid.ColumnSpan="3" Text="ðŸ“Š MÃ©tricas Detalhadas" 
                           Style="{StaticResource CardTitleStyle}" Margin="0,0,0,16"/>
                
                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,0,12">
                  <TextBlock Text="Nome do UPS" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding UpsName}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,0,12">
                  <TextBlock Text="Status" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding Status}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,0,0,12">
                  <TextBlock Text="Runtime" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding TimeLeft}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,0,12">
                  <TextBlock Text="Bateria" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding BatteryPercent, StringFormat='{}{0}%'}" FontSize="14" Foreground="#10B981" FontWeight="Bold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="2" Grid.Column="1" Margin="0,0,0,12">
                  <TextBlock Text="Carga" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding LoadPercent, StringFormat='{}{0}%'}" FontSize="14" Foreground="#F59E0B" FontWeight="Bold"/>
                </StackPanel>

                <!-- SaÃºde da Bateria -->
                <StackPanel Grid.Row="3" Grid.ColumnSpan="3" Margin="0,8,0,0">
                  <TextBlock Text="SaÃºde da Bateria" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding BatteryHealthText}" FontSize="14" FontWeight="SemiBold" Foreground="{Binding BatteryHealthBrush}"/>
                  <TextBlock Text="{Binding BatteryHealthDetails}" FontSize="11" Foreground="#CCCCCC"/>
                </StackPanel>
                
                <StackPanel Grid.Row="2" Grid.Column="2" Margin="0,0,0,12">
                  <TextBlock Text="Consumo" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding LoadWatts}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="3" Grid.Column="0" Margin="0,0,0,12">
                  <TextBlock Text="TensÃ£o Entrada" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding InputVoltage}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="3" Grid.Column="1" Margin="0,0,0,12">
                  <TextBlock Text="TensÃ£o SaÃ­da" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding OutputVoltage}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="3" Grid.Column="2" Margin="0,0,0,12">
                  <TextBlock Text="FrequÃªncia" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding LineFreq}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="4" Grid.Column="0" Margin="0,0,0,12">
                  <TextBlock Text="Temperatura" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding Temperature}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="4" Grid.Column="1" Margin="0,0,0,12">
                  <TextBlock Text="Status da TensÃ£o" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding VoltageStatus}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
                
                <StackPanel Grid.Row="4" Grid.Column="2" Margin="0,0,0,12">
                  <TextBlock Text="Tempo em Bateria" FontSize="11" Foreground="#AAAAAA"/>
                  <TextBlock Text="{Binding BatteryTimeInfo}" FontSize="14" Foreground="#FFFFFF" FontWeight="SemiBold"/>
                </StackPanel>
              </Grid>
            </Border>
            
            <!-- Card adicional para estimativa de recarga -->
            <Border Style="{StaticResource CardStyle}">
              <StackPanel>
                <TextBlock Text="ðŸ”‹ Estimativa de Recarga" Style="{StaticResource CardTitleStyle}"/>
                <TextBlock Text="{Binding ChargeEstimate}" FontSize="16" Foreground="#10B981" FontWeight="Bold"/>
              </StackPanel>
            </Border>
          </StackPanel>
        </ScrollViewer>
      </TabItem>
    </TabControl>
  </Grid>
</Window>
